<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-TP Profit Calculator | Trading Tool</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #0b0c10;
        color: #c5c6c7;
        margin: 0;
        padding: 0;
    }
    header {
        background: #1f2833;
        padding: 20px;
        text-align: center;
        border-bottom: 2px solid #66fcf1;
    }
    header h1 { color: #66fcf1; margin: 0; font-size: 1.8rem; }
    
      main, .description {
        max-width: 600px;
        margin: 40px auto;
        background: #1f2833;
        padding: 25px 30px;
        border-radius: 12px;
        box-shadow: 0 0 20px rgba(0,255,255,0.1);
    }

    h2 { color: #45a29e; text-align: center; }
    label { display: block; margin-top: 15px; margin-bottom: 5px; font-weight: bold; }
    input[type="number"], select, input[type="text"] {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: none;
        background: #0b0c10;
        color: #c5c6c7;
        box-shadow: inset 0 0 5px #45a29e;
    }
    input::placeholder { color: #66fcf1; }
    button {
        margin-top: 20px;
        width: 100%;
        padding: 12px;
        background: #45a29e;
        color: #0b0c10;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    button:hover { background: #66fcf1; color: #1f2833; }

    .result {
        margin-top: 25px;
        padding: 15px;
        background: #0b0c10;
        border: 1px solid #45a29e;
        border-radius: 8px;
        text-align: center;
        font-size: 1.2rem;
    }
    .tp-inputs input { margin-bottom: 10px; }

    #warning {
        display: none;
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 15px 25px;
        border-radius: 10px;
        background: #ff4d4d;
        color: white;
        font-weight: bold;
        text-align: center;
        box-shadow: 0 0 15px #ff9999;
        font-size: 1.1rem;
        z-index: 9999;
    }
    #warning button {
        margin-left: 15px;
        background: white;
        color: #ff4d4d;
        border: none;
        border-radius: 5px;
        padding: 3px 8px;
        font-weight: bold;
        cursor: pointer;
    }

    .sl-result { color: red; font-weight: bold; margin-top: 10px; display: block; }

      .persian {
        direction: rtl;
        text-align: right;
        font-family: 'Tahoma', 'Segoe UI', sans-serif;
    }


</style>

</head>
<body>

<header>
    <h1>TradePulse - Multi-TP Profit Calculator</h1>
</header>

<div id="warning">
    ⚠️ <span id="warning-text"></span>
    <button onclick="clearWarning()">OK</button>
</div>

<main>
    <h2>Calculate Total Profit for Multiple Take-Profits</h2>

    <label>Margin ($)</label>
    <input type="number" id="margin" value="600">

    <label id="leverage-label">Leverage (x)</label>
    <input type="number" id="leverage" value="20">

    <label>Entry Prices ($) - comma separated for multiple entries</label>
    <input type="text" id="entry" value="0.3547,0.3560">

    <label>Stop Loss Price ($)</label>
    <input type="number" id="sl" step="0.0001" value="0.3400">

    <label>Take-Profit Prices (comma separated)</label>
    <input type="text" id="tps" value="0.3606,0.3636">

    <label>Calculation Mode</label>
    <select id="mode" onchange="toggleLeverage()">
        <option value="dollar_leverage">Dollar Profit (With Leverage - Futures)</option>
        <option value="dollar_no_leverage">Dollar Profit (Without Leverage - Spot)</option>
    </select>

    <label>Position Type</label>
    <select id="position">
        <option value="long">Long</option>
        <option value="short">Short</option>
    </select>

    <button onclick="calculateProfit()">Calculate Profit</button>

    <div class="result" id="result">Total Profit: $0.00</div>
</main>

<section class="description">
    <h2>TradePulse - Multi-TP Profit Calculator</h2>
    <p>Easily calculate your potential profits and losses for multiple take-profit levels in crypto or stock trading. Enter your <strong>margin</strong>, <strong>leverage</strong>, <strong>entry price</strong>, <strong>stop loss</strong>, and <strong>take-profit targets</strong> to see your <strong>profit per TP</strong>, <strong>total profit</strong>, and <strong>stop-loss impact</strong>. Supports both <strong>long</strong> and <strong>short positions</strong>, as well as <strong>spot</strong> (no leverage) and <strong>futures</strong> (with leverage) trading.</p>
    <p>Optimize your trades and manage risk with a clear, fast, and intuitive tool.</p>

    <hr>

    <h2 class="persian">TradePulse - ماشین حساب چندین حد سود (TP)</h2>
    <p class="persian">به‌راحتی سود و زیان احتمالی خود را برای چندین سطح <strong>حد سود</strong> در معاملات کریپتو یا بورس محاسبه کنید. <strong>مارجین، لوریج، قیمت ورود، حد ضرر</strong> و <strong>قیمت‌های هدف (TP)</strong> خود را وارد کنید تا <strong>سود هر TP، سود کل</strong> و <strong>تاثیر حد ضرر</strong> را ببینید. از <strong>پوزیشن‌های لانگ و شورت</strong> و همچنین معاملات <strong>اسپات (بدون لوریج)</strong> و <strong>فیوچرز (با لوریج)</strong> پشتیبانی می‌کند.</p>
    <p class="persian">با این ابزار سریع و ساده، معاملات خود را بهینه کنید و ریسک را مدیریت کنید.</p>
<br> <br> 
    <div class="persian">
        <h2 >کانال تلگرام</h2>
        <p>برای عضویت روی علامت زیر کلیک کنید و عضو شوید</p>
    <a href="https://t.me/tradepulseTPL" target="_blank">
    <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" 
         alt="Telegram" 
         style="width:35px;">
</a>

    </div>
    
</section>

<footer style="text-align:center; margin-top:40px; color:#45a29e;">
    Designed for traders & crypto enthusiasts
</footer>

<script>
function toggleLeverage() {
    let mode = document.getElementById("mode").value;
    if (mode === "dollar_no_leverage") {
        document.getElementById("leverage").style.display = "none";
        document.getElementById("leverage-label").style.display = "none";
        document.getElementById("position").disabled = true;
    } else {
        document.getElementById("leverage").style.display = "block";
        document.getElementById("leverage-label").style.display = "block";
        document.getElementById("position").disabled = false;
    }
}

function showWarning(msg) {
    document.getElementById("warning-text").innerHTML = msg;
    document.getElementById("warning").style.display = "block";
}

function clearWarning() {
    document.getElementById("warning").style.display = "none";
}

function calculateProfit() {
    clearWarning();

    let margin = parseFloat(document.getElementById("margin").value);
    let leverage = parseFloat(document.getElementById("leverage").value) || 1;
    const entryInput = document.getElementById("entry").value;
    const sl = parseFloat(document.getElementById("sl").value);
    const mode = document.getElementById("mode").value;
    const position = document.getElementById("position").value;

    // Parse multiple entry prices
    const entries = entryInput.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
    if(entries.length === 0) { showWarning("Please enter valid entry prices."); return; }

    // Weighted average entry
    const avgEntry = entries.reduce((sum,p) => sum + p, 0) / entries.length;

    // Parse TPs
    const tps = document.getElementById("tps").value.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
    if(tps.length === 0){ showWarning("Please enter valid TP prices."); return; }

    if(mode === "dollar_no_leverage") leverage = 1;
    const actualPosition = mode === "dollar_no_leverage" ? "long" : position;

    // Validate SL and TP based on position
    if (actualPosition === "long") {
        if (tps.some(tp => tp <= avgEntry)) { showWarning("TPs for long should be above average entry."); return; }
        if (sl >= avgEntry) { showWarning("SL for long should be below average entry."); return; }
    } else {
        if (tps.some(tp => tp >= avgEntry)) { showWarning("TPs for short should be below average entry."); return; }
        if (sl <= avgEntry) { showWarning("SL for short should be above average entry."); return; }
    }

    let totalProfit = 0;
    let outputText = "";

    tps.forEach((tp,i) => {
        const portion = margin / tps.length;
        let profit = actualPosition === "long"
            ? portion * leverage * (tp - avgEntry) / avgEntry
            : portion * leverage * (avgEntry - tp) / avgEntry;

        totalProfit += profit;
        outputText += `TP${i+1} @ $${tp}: <span style="color:${profit>=0?'lime':'red'}">$${profit.toFixed(2)}</span><br>`;
    });

    // SL
    let slProfit = actualPosition === "long"
        ? margin * leverage * (sl - avgEntry) / avgEntry
        : margin * leverage * (avgEntry - sl) / avgEntry;

    document.getElementById("result").innerHTML =
        `Avg Entry: <span style="color:yellow">$${avgEntry.toFixed(4)}</span><br>` +
        outputText +
        `<br><b style="color:${totalProfit>=0?'lime':'red'}">Total Profit: $${totalProfit.toFixed(2)}</b>` +
        `<br><span class="sl-result">SL @ $${sl} → $${slProfit.toFixed(2)}</span>`;
}

toggleLeverage();
</script>

</body>
</html>
